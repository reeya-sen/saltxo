class CountdownTimer extends HTMLElement{constructor(){super()}connectedCallback(){this.days_container=this.querySelector(".countdown-timer--item"),this.digits=this.querySelectorAll(".countdown-timer--digit"),this.hide_when_expired="true"===this.getAttribute("data-hide-expired"),this.show_button_when=this.getAttribute("data-show-button-when");var t=this.getAttribute("data-expiry-date").split("-"),e=this.getAttribute("data-expiry-hours"),i=this.getAttribute("data-expiry-minutes");this.countdown_date=this.initDate(...t,e,i),this.initTimer(),this.startTimer(),this.addStateListener()}disconnectedCallback(){this.timer&&clearInterval(this.timer)}initDate(t,e,i,s,n){let r;return theme.utils.areNumericStrings(t,e,i)?r=new Date(Date.UTC(i,e-1,t,s,n)):((r=new Date).setHours(0,0,0,0),r.setDate(r.getDate()+1)),r.getTime()}addStateListener(){this.digits.on("transitionend",({target:t})=>{"slide-out"===t.getAttribute("data-transition-type")&&t.removeAttribute("data-transition-type")})}initTimer(){var t=(new Date).getTime(),e=new Date(t).getTime();this.distance=this.countdown_date-e,this.updateTime()}startTimer(){this.timer=setInterval(()=>{this.distance-=1e3,this.updateTime()},1e3)}updateTime(){var t;this.checkIfFinished()||(t=this.getDigits(),this.renderDigits(t))}checkIfFinished(){if(0<this.distance)return!1;clearInterval(this.timer);var t,e=this.closest("[data-countdown-container]");return e&&(this.hide_when_expired&&(e.style.display="none"),(t=e.querySelector("[data-countdown-button]"))&&"finished"===this.show_button_when?t.style.display="block":t&&"active"===this.show_button_when&&(t.style.display="none")),!0}getDigits(){var t=Math.floor(this.distance%6e4/1e3),e=9<t?t.toString().split("").map(Number):[0,t],i=Math.floor(this.distance%36e5/6e4),s=9<i?i.toString().split("").map(Number):[0,i],n=Math.floor(this.distance%864e5/36e5),r=9<n?n.toString().split("").map(Number):[0,n],a=Math.floor(this.distance/864e5);return[...99<a?[9,9]:9<a?a.toString().split("").map(Number):[0,a],...r,...s,...e]}renderDigits(r){this.days_container.setAttribute("aria-hidden",0===r[0]&&0===r[1]),this.digits.forEach((t,e)=>{var i,s,n=r[e];n!==parseInt(t.dataset.value)&&(t.setAttribute("data-value",n),i=parseInt(t.getAttribute("data-index")),t.setAttribute("data-index",s=0===i?1:0),t.children[s].innerText=n,t.children[s].setAttribute("data-transition-type","slide-in"),t.children[i].setAttribute("data-transition-type","slide-out"))})}}const countdownTimerEl=customElements.get("countdown-timer");countdownTimerEl||customElements.define("countdown-timer",CountdownTimer);