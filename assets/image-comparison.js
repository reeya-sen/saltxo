class ImageComparisonSection extends HTMLElement{constructor(){super(),this.container=this.querySelector(".image-comparison--images"),this.cursor=this.querySelector(".image-comparison--cursor"),this.direction=this.getAttribute("data-cursor-direction"),this.text_containers=this.querySelectorAll(".image-comparison--before-text, .image-comparison--after-text")}connectedCallback(){this.transitionObserver(),this.getDimensions(),this.cursorListeners(),this.resizeObserver()}transitionObserver(){this.on("transitionend",({target:t})=>{t===this.cursor.parentNode&&(this.style.setProperty("--image-comparison--transition","none"),this.off("transitionend"))}),new IntersectionObserver(([{isIntersecting:t}],e)=>{t&&(e.disconnect(),this.setCursor(this.getAttribute("data-initial-pos")))},{threshold:.3}).observe(this.container)}setCursor(t){this.style.setProperty("--image-comparison--cursor-pos",t+"%")}getDimensions(){this.total="horizontal"===this.direction?this.container.offsetWidth:this.container.offsetHeight,this.offset="horizontal"===this.direction?this.container.offset().left:this.container.offset().top}resizeObserver(){new ResizeObserver(()=>this.getDimensions()).observe(this)}cursorListeners(){const e="vertical"===this.direction&&theme.utils.isTouchDevice;this.cursor.on("mousedown touchstart",()=>{this.cursor.style.cursor="grabbing",theme.utils.disable_swipe_listener=!0,this.toggleText(!1)},{passive:!0}),window.on("mousemove touchmove",t=>{theme.utils.disable_swipe_listener&&(e&&t.preventDefault(),this.animation_request&&cancelAnimationFrame(this.animation_request),this.animation_request=requestAnimationFrame(()=>this.moveCursor(t)))},{passive:!e}),window.on("mouseup touchend",()=>{this.cursor.style.cursor="unset",theme.utils.disable_swipe_listener=!1,this.toggleText(!0)},{passive:!0})}toggleText(e){this.text_containers.length&&this.text_containers.forEach(t=>t.setAttribute("data-transition-active",e))}moveCursor(t){let e,s=("horizontal"===this.direction?e=("touchmove"===t.type?t.targetTouches[0]:t).pageX:"vertical"===this.direction&&(e=("touchmove"===t.type?t.targetTouches[0]:t).pageY),(100*(e-this.offset)/this.total).toFixed(2));95<s?s=95:s<5&&(s=5),this.setCursor(s)}}const imageComparisonEl=customElements.get("image-comparison");imageComparisonEl||customElements.define("image-comparison",ImageComparisonSection);